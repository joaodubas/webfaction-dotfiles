#!/usr/bin/env bash
# environment variables
bindir=$HOME/local/bin
if [[ ":$PATH:" != *":$bindir:"* ]]; then
    PATH=$bindir:$PATH
    export PATH
fi
LD_LIBRARY_PATH=$HOME/local/lib
LIBRAY_PATH=$LD_LIBRARY_PATH
C_INCLUDE_PATH=$LD_LIBRARY_PATH
CPLUS_INCLUDE_PATH=$LD_LIBRARY_PATH
export LD_LIBRARY_PATH
export LIBRARY_PATH
export C_INCLUDE_PATH
export CPLUS_INCLUDE_PATH

# local development
export PROJECTS=$HOME/public

# virtualenv
export WORKON_HOME=$HOME/.venv
export PROJECT_HOME=$HOME/public
. /usr/local/bin/virtualenvwrapper.sh

# golang
export GOROOT=$HOME/local/src/go
export GOPATH=$HOME/local/go
if [[ ":$PATH:" != *":$GOPATH/bin:"* ]]; then
	PATH=$GOPATH/bin:$PATH
	export PATH
fi

# aliases
sublime() {
    $bindir/sublime $@ &
}

startmux() {
    tmux new -s dev
}

docker-install() {
    local repo=$(cat REPOSITORY)
    local tag=$(cat TAG)
    local image=${repo}:${tag}

    docker build --rm --tag ${image} .
    docker tag ${image} ${repo}:latest
}

docker-ui() {
    docker run -d \
        --name dockerui \
        -p 9000:9000 \
        -v /var/run/docker.sock:/docker.sock \
        crosbymichael/dockerui \
            -e /docker.sock
}

docker-registry() {
    local storage_path=/registry
    local storage_name=registry-storage
    local registry_name=registry

    docker run -d \
        -v ${storage_path} \
        --name ${storage_name} \
        ubuntu:14.04 \
        /bin/true

    docker run -d \
        -p 5000:5000 \
        -e SETTINGS_FLAVOR=local \
        -e STORAGE_PATH=${storage_path} \
        -e SEARCH_BACKEND=sqlalchemy \
        --volumes-from ${storage_name} \
        --name ${registry_name} \
        registry
}

fig () {
	docker run -i -t --rm \
		-v ${PWD}:${PWD} \
		-v /var/run/docker.sock:/var/run/docker.sock \
		-w ${PWD} \
		dduportal/fig:latest \
			$@
}

# Personal hook configurations
if [ -f ~/.localrc ]; then
    . ~/.localrc
fi
